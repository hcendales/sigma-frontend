<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>sigma2-frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">sigma2-frontend documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li
  >
  LooseObject</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/mejoramiento/vincular-pks/components/tabla-seguimientos/tabla-seguimientos.component.ts</code>
        </p>






            <section>
    <h3 id="inputs">Indexable</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <code>[key: string]:        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="454" class="link-to-prism">src/app/mejoramiento/vincular-pks/components/tabla-seguimientos/tabla-seguimientos.component.ts:454</a></div>
                            </td>
                        </tr>
            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, EventEmitter, Input, OnInit, Output, ViewChild } from &#x27;@angular/core&#x27;;
import { FormControl } from &#x27;@angular/forms&#x27;;
import { MatDialog } from &#x27;@angular/material/dialog&#x27;;
import { MatPaginator } from &#x27;@angular/material/paginator&#x27;;
import { MatSort } from &#x27;@angular/material/sort&#x27;;
import { MatTableDataSource } from &#x27;@angular/material/table&#x27;;
import { ActivatedRoute, Router } from &#x27;@angular/router&#x27;;
import { ConsultaListaRevisionVisitaService } from &#x27;src/app/core/services/consulta-lista-revision-visita.service&#x27;;
import { VincularRadicadoService } from &#x27;src/app/core/services/vincular-radicado.service&#x27;;
import { SimpleDialogComponent } from &#x27;src/app/core/simple-dialog/simple-dialog.component&#x27;;
import * as XLSX from &#x27;xlsx&#x27;;
@Component({
  selector: &#x27;app-tabla-seguimientos&#x27;,
  templateUrl: &#x27;./tabla-seguimientos.component.html&#x27;,
  styleUrls: [&#x27;./tabla-seguimientos.component.scss&#x27;]
})
export class TablaSeguimientosComponent implements OnInit {
  displayedColumns: string[] &#x3D; [&#x27;checks&#x27;, &#x27;pk_id_calzada&#x27;, &#x27;civ&#x27;, &#x27;tipo_malla&#x27;, &#x27;descripcion_zona&#x27;, &#x27;descripcion_localidad&#x27;,
  &#x27;descripcion_barrio&#x27;, &#x27;descripcion_upz&#x27;, &#x27;seccion_vial&#x27;, &#x27;km_carril_impacto&#x27;, &#x27;codigo_actividad_agrupada&#x27;, &#x27;posible_danio_redes&#x27;,
  &#x27;indice_priorizacion&#x27;, &#x27;fecha_visita_tecnica&#x27;, &#x27;seguimientos&#x27;,
  &#x27;mes_ultima_fecha_seguimiento_masanio&#x27;, &#x27;dias_desde_ultima_visita&#x27;, &#x27;fecha_terminacion&#x27;
  //&#x27;id_mantenimiento_vial&#x27;
  ];

  // Datos para la lista
  dataSource!: MatTableDataSource&lt;any&gt;;
  // MatPaginator Inputs
  //filterColumns: string[] &#x3D; [&#x27;ch&#x27;, &#x27;search2&#x27;, &#x27;search3&#x27;, &#x27;search4&#x27;, &#x27;search5&#x27;, &#x27;search6&#x27;] ;
    //&#x27;ch&#x27;,&#x27;search1&#x27;, &#x27;search2&#x27;, &#x27;search3&#x27;, &#x27;search4&#x27;, &#x27;search5&#x27;, &#x27;search6&#x27;, &#x27;search7&#x27;, &#x27;search8&#x27;,
    //&#x27;search9&#x27;, &#x27;search10&#x27;] ;
  filterColumns: string[] &#x3D; [];
  searchkey &#x3D; &#x27;&#x27;;
  registros:any[] &#x3D; [];
  // Campos de filtro en el formulario
  // search0 &#x3D; new FormControl(&#x27;&#x27;);
  public formControls:FormControl[] &#x3D; [];

  filterValues &#x3D; {
    pk_id_calzada: &#x27;&#x27;,
    civ: &#x27;&#x27;,
    id_mantenimiento_vial: &#x27;&#x27;,
    fecha_visita_tecnica: &#x27;&#x27;,
    seguimientos: &#x27;&#x27;,
    mes_ultima_fecha_seguimiento_masanio: &#x27;&#x27;,
    dias_desde_ultima_visita: &#x27;&#x27;,
    fecha_terminacion: &#x27;&#x27;,
    descripcion_localidad: &#x27;&#x27;,
    descripcion_zona: &#x27;&#x27;,
    descripcion_barrio: &#x27;&#x27;,
    descripcion_upz: &#x27;&#x27;,
    tipo_malla: &#x27;&#x27;,
    seccion_vial: &#x27;&#x27;,
    indice_priorizacion: &#x27;&#x27;,
    km_carril_impacto: &#x27;&#x27;,
    codigo_actividad_agrupada: &#x27;&#x27;,
    posible_danio_redes: &#x27;&#x27;
  };

  // tslint:disable-next-line: member-ordering
  @ViewChild(MatSort) sort: any;
  @ViewChild(MatPaginator) paginator: any;

  // Propiedad para leer parametros
  @Input() idActividad &#x3D; 5;
  @Input() idActividadTransicion &#x3D; 9;
  @Input() selectedFeatures:any;
  @Output() registroSeleccionado: EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  @Output() dataSourceEmiter: EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  @Output() selecteDataSourceEmiter: EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  @Output() irAPkEmiter: EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  @Output() filterPKs: EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  selectedList:any &#x3D; {} as any;

  masterCheck:boolean &#x3D; false;

  loadingData:boolean &#x3D; false;
  products: any;
  file: any;
  @ViewChild(&#x27;inputXls&#x27;) inputXls: any;

  constructor(
    private revisioVisitasService: ConsultaListaRevisionVisitaService,
    private router: Router,
    public dialog: MatDialog,
    private gestionService: VincularRadicadoService,
    private activatedroute: ActivatedRoute) {
       //this.dataSource &#x3D;  new MatTableDataSource();
   }

    ngOnChanges(e:any){
        console.log(&#x27;taa: &#x27;, e);
        if(!e){return;}
        let selectedFeatures &#x3D; e.selectedFeatures ? e.selectedFeatures.currentValue : null;
        if(selectedFeatures &amp;&amp; this.dataSource &amp;&amp; this.dataSource.filteredData){
          console.log(&#x27;tabla: &#x27;, e.selectedFeatures);
          this.registros &#x3D; [];
          this.dataSource.filteredData.forEach((v:any)&#x3D;&gt;{
            if(selectedFeatures.includes(v.pk_id_calzada)){
              v.checked &#x3D; true;
              this.selectedList[v.pk_id_calzada] &#x3D; v;
              this.registros.push(v);
            }else{
              v.checked &#x3D; false;
            }
          });
          this.registroSeleccionado.emit(this.registros);
          //this.selecteDataSourceEmiter.emit(this.registros);
          }
    }

    ngOnInit() {
      this.consultarData();
    }

    creaFiltro(){
      this.dataSource.filterPredicate &#x3D; ((data, filter) &#x3D;&gt; {
        // console.log(&#x27;Filtro: &#x27;, filter);
        const searchTerms &#x3D; JSON.parse(filter);
        // console.log(&#x27;searchTerms: &#x27;, searchTerms);
        return (data.pk_id_calzada || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.pk_id_calzada) !&#x3D;&#x3D; -1
        &amp;&amp; (data.civ || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.civ) !&#x3D;&#x3D; -1
        &amp;&amp; (data.fecha_visita_tecnica || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.fecha_visita_tecnica) !&#x3D;&#x3D; -1
        &amp;&amp; (data.seguimientos || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.seguimientos) !&#x3D;&#x3D; -1
        &amp;&amp; (data.mes_ultima_fecha_seguimiento_masanio || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.mes_ultima_fecha_seguimiento_masanio) !&#x3D;&#x3D; -1
        &amp;&amp; (data.dias_desde_ultima_visita || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.dias_desde_ultima_visita) !&#x3D;&#x3D; -1
        &amp;&amp; (data.fecha_terminacion || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.fecha_terminacion) !&#x3D;&#x3D; -1
        &amp;&amp; (data.descripcion_localidad || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.descripcion_localidad) !&#x3D;&#x3D; -1
        &amp;&amp; (data.descripcion_zona || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.descripcion_zona) !&#x3D;&#x3D; -1
        &amp;&amp; (data.descripcion_barrio || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.descripcion_barrio) !&#x3D;&#x3D; -1
        &amp;&amp; (data.descripcion_upz || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.descripcion_upz) !&#x3D;&#x3D; -1
        &amp;&amp; (data.km_carril_impacto || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.km_carril_impacto) !&#x3D;&#x3D; -1
        &amp;&amp; (data.tipo_malla || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.tipo_malla) !&#x3D;&#x3D; -1
        &amp;&amp; (data.seccion_vial || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.seccion_vial) !&#x3D;&#x3D; -1
        &amp;&amp; (data.indice_priorizacion || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.indice_priorizacion) !&#x3D;&#x3D; -1
        &amp;&amp; (data.codigo_actividad_agrupada || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.codigo_actividad_agrupada) !&#x3D;&#x3D; -1
        &amp;&amp; (data.posible_danio_redes || &#x27;&#x27;).toString().toLowerCase().indexOf(searchTerms.posible_danio_redes) !&#x3D;&#x3D; -1
      });
      setTimeout(() &#x3D;&gt; {
        //this.dataSource.paginator &#x3D; this.paginator;
        //this.dataSource.sort      &#x3D; this.sort;
      });
    }
    irAPk (pk: number) {
      let w &#x3D; &quot;PK_ID_ELEMENTO &#x3D; &quot; + pk.toString();
      console.log(w);
      this.irAPkEmiter.emit(w);
    }
    applyFilter(valor: string): void {
      this.dataSource.filter &#x3D; valor.trim().toLowerCase();
      if (this.dataSource.paginator) {
        this.dataSource.paginator.firstPage();
      }
    }
    // tslint:disable-next-line: typedef
    onSearchClear(){
      this.searchkey &#x3D; &#x27;&#x27;;
      this.applyFilter(&#x27;&#x27;);
    }
    // tslint:disable-next-line: typedef
    onClearFilters(){
      for (let c of this.formControls){
        c.setValue(&#x27;&#x27;);
      }
    }
    cargarColumnas(){
      this.filterColumns &#x3D; [];
      this.formControls &#x3D; [];

      for(let a of this.displayedColumns){
        this.filterColumns.push(a+&#x27;_&#x27;);
        if(!a.startsWith(&#x27;_CTRL_ACCION_&#x27;)){
          let formControl &#x3D; new FormControl(&#x27;&#x27;);
          formControl.valueChanges
            .subscribe(
              valor &#x3D;&gt; {
                const attr:string &#x3D; a as string;
                (this.filterValues as LooseObject)[attr] &#x3D; valor;
                this.dataSource.filter &#x3D; JSON.stringify(this.filterValues);
                //this.inArr &#x3D; [];
                console.log(this.dataSource.filteredData);
                //this.registros &#x3D; this.dataSource.filteredData;
                this.filterPKs.emit(this.dataSource.filteredData);//.forEach((value: { pk_id_calzada: any; }) &#x3D;&gt; {
                  //this.inArr.push(value.pk_id_calzada);
                //});
                //this.cargaMapa(true);
              }
            );
          this.formControls.push(formControl);
        }
      }

    }
    // tslint:disable-next-line: typedef
    updateCheckedList(event: any, index: any){
      if ( event.checked ){
        this.selectedList[index.pk_id_calzada] &#x3D; index;
      }else{
        delete this.selectedList[index.pk_id_calzada];
      }
      let arrayChecked &#x3D; [];
      for(let key in this.selectedList){
        arrayChecked.push(this.selectedList[key]);
      }
      console.log(arrayChecked);
      this.registroSeleccionado.emit(arrayChecked);
      this.selecteDataSourceEmiter.emit(arrayChecked);
      if(!this.isAlternated()){
        this.masterCheck &#x3D; this.dataSource.filteredData[0].checked;
      }
    }

    getClassTiempo(fecha: number): string{
      const hoy &#x3D; new Date().getTime();
      const ven &#x3D; new Date(fecha).getTime();
      let day &#x3D; hoy - ven;
      day &#x3D; Math.round(day / ( 1000 * 60 * 60 * 24));
      if ( day &#x3D;&#x3D;&#x3D; -1 ){
        return &#x27;undia&#x27;;
      }
      else{
        if (day &gt;&#x3D; 0 ){
          return &#x27;retraso&#x27;;
        }
      }
      return &#x27;normal&#x27;;
    }


    clearchecked(){
      if(this.dataSource ){
        this.masterCheck &#x3D; false;
        this.masterToggle({checked:false});
      }
    }

    //evento cuando se hace click en ek check de la cabecera
    masterToggle(e:any){
      if(this.dataSource){
        this.selectedList &#x3D; {};
        for(let i&#x3D;0;i&lt;this.dataSource.filteredData.length;i++){
         // if(this.dataSource.filteredData[i].checked !&#x3D; e.checked){

            //this.updateCheckedList(e,this.dataSource.filteredData[i]);
            this.dataSource.filteredData[i].checked &#x3D; e.checked;
            this.selectedList[this.dataSource.filteredData[i].pk_id_calzada] &#x3D; this.dataSource.filteredData[i];
          //}
        }
        let arrayChecked &#x3D; [];
        if(e.checked){
          for(let key in this.selectedList){
            arrayChecked.push(this.selectedList[key]);
          }
        }else{
          this.selectedList &#x3D; {};
        }
        this.selecteDataSourceEmiter.emit(arrayChecked);
        this.registroSeleccionado.emit(arrayChecked);
        console.log(arrayChecked);
      }
    }

    //verifica si hay algunos registros seleccionados, para establecer el estado &quot;indeterminado&quot; del check de la cabecera
    isAlternated(){
      if(this.dataSource &amp;&amp; this.dataSource.filteredData.length &gt;1){
        let antValue &#x3D; this.dataSource.filteredData[0].checked;
        for(let i &#x3D; 1; i&lt;this.dataSource.filteredData.length;i++){
          if(this.dataSource.filteredData[i].checked !&#x3D; antValue){
            return true;
          }else{
            antValue &#x3D; this.dataSource.filteredData[i].checked;
          }
        }
      }
      return false;
    }
    public sortData(): void {
        switch (this.sort.direction) {
          case &#x27;asc&#x27;:
            this.sort.direction &#x3D; &#x27;asc&#x27;;
            break;
          case &#x27;desc&#x27;:
            this.sort.direction &#x3D; &#x27;desc&#x27;;
            break;
          default:
            this.sort.direction &#x3D; &#x27;asc&#x27;;
        }
    }
    eliminarPk(pk:any) {
      const index &#x3D; this.dataSource.data.indexOf(pk);
      this.dataSource.data.splice(index, 1);
      //this.dataSourceSolicitudes &#x3D; this.dataSourceSolicitudes.filter((item, index) &#x3D;&gt; index !&#x3D;&#x3D; pk);
      this.dataSource._updateChangeSubscription();
    }
    agregarPKs(pks:any[]) {
      let scope &#x3D; this;
      pks.forEach((v:any)&#x3D;&gt;{
        let pkFilter &#x3D; this.dataSource.data.filter((data)&#x3D;&gt;{
          return data.PK_ID_ELEMENTO &#x3D;&#x3D; v.attributes.PK_ID_ELEMENTO;
        });
        //if(pkFilter.length&#x3D;&#x3D;0)
          this.dataSource.data.push(v.attributes);
        /*else {
          const dialogRef &#x3D; this.dialog.open(SimpleDialogComponent,{
            data: {
              titulo: &#x27;Vincular Pks a peticionario&#x27;,
              contenido: &#x27;Este PK ya fué vinculado.&#x27;,
              acepytar: false,
              cancelar: true
            }
          });
          dialogRef.afterClosed().subscribe(result &#x3D;&gt; {
            return;
          });
        }*/
      });
      this.dataSource._updateChangeSubscription();
    }
    agregarPk(pk:any) {
      let scope &#x3D; this;
      let pkFilter &#x3D; this.dataSource.data.filter((data)&#x3D;&gt;{
        return data.PK_ID_ELEMENTO &#x3D;&#x3D; pk.PK_ID_ELEMENTO;
      });
      if(pkFilter.length&#x3D;&#x3D;0)
        this.dataSource.data.push(pk);
      else {
        const dialogRef &#x3D; this.dialog.open(SimpleDialogComponent,{
          data: {
            titulo: &#x27;Asignar Pks a Seguimiento&#x27;,
            contenido: &#x27;Este PK ya fué vinculado.&#x27;,
            cerrar: true,
            cancelar: false,
            aceptar: false
          }
        });
        dialogRef.afterClosed().subscribe(result &#x3D;&gt; {
          return;
        });
      }

      this.dataSource._updateChangeSubscription();
    }
    async consultarData (){

      if(!this.loadingData){
        this.dataSource &#x3D; new MatTableDataSource();
        this.loadingData &#x3D; true;
        try{
          let respServ &#x3D; await this.gestionService.getSegs();
          if(respServ.codError &#x3D;&#x3D; 0){
            this.dataSource &#x3D; new MatTableDataSource(respServ.respuesta);
            this.dataSource.sortingDataAccessor &#x3D; (item, property) &#x3D;&gt; {
              if(property &#x3D;&#x3D; &quot;checks&quot;)
                return item.checked ? 1 : 0;
              else
                return item[property];
            };
            this.dataSource.sort &#x3D; this.sort;
            this.dataSource.paginator &#x3D; this.paginator;
            this.creaFiltro();
            this.onClearFilters();
            this.loadingData &#x3D; false;
            this.cargarColumnas();
            //this.filterColumns &#x3D; [];
            //await this.setFilterColoumns();
            this.dataSourceEmiter.emit(this.dataSource.data);
          }
        }catch(e){
          console.log(e);
          this.loadingData &#x3D; false;
        }
      }
      else{
        this.dataSourceEmiter.emit(this.dataSource.data);
      }
    }

    exportexcel() {
      if (this.registros.length &gt; 0) {
        let headers &#x3D; {header:[
          &#x27;CIV&#x27;,
          &#x27;PK ID&#x27;,
          &#x27;FECHA_VISITA_TECNICA&#x27;,
          &#x27;SEGUIMIENTOS&#x27;,
          &#x27;ULTIMA_FECHA_SEGUIMIENTO&#x27;,
          &#x27;DIAS_DESDE_ULTIMA_VISITA&#x27;,
          &#x27;FECHA_TERMINACION&#x27;,
          &#x27;TIPO_MALLA&#x27;,
          &#x27;SECCION_VIAL&#x27;,
          &#x27;INDICE_PRIORIZACION&#x27;,
          &#x27;KM_CARRIL_IMPACTO&#x27;,
          &#x27;ACTIVIDAD_AGRUPADA&#x27;,
          &#x27;POSIBLE_DANIO_REDES&#x27;
        ]};

        let datos &#x3D; [];
        for (let registro of this.registros) {
          datos.push({
            &#x27;CIV&#x27;: registro.civ,
            &#x27;PK ID&#x27;: registro.pk_id_calzada,
            &#x27;FECHA_VISITA_TECNICA&#x27;: registro.fecha_visita_tecnica,
            &#x27;SEGUIMIENTOS&#x27;: registro.seguimientos,
            &#x27;ULTIMA_FECHA_SEGUIMIENTO&#x27;: registro.mes_ultima_fecha_seguimiento_masanio,
            &#x27;DIAS_DESDE_ULTIMA_VISITA&#x27;: registro.dias_desde_ultima_visita,
            &#x27;FECHA_TERMINACION&#x27;: registro.fecha_terminacion,
            &#x27;TIPO_MALLA&#x27;: registro.tipo_malla,
            &#x27;SECCION_VIAL&#x27;: registro.seccion_vial,
            &#x27;INDICE_PRIORIZACION&#x27;: registro.indice_priorizacion,
            &#x27;KM_CARRIL_IMPACTO&#x27;: registro.km_carril_impacto,
            &#x27;ACTIVIDAD_AGRUPADA&#x27;: registro.codigo_actividad_agrupada,
            &#x27;POSIBLE_DANIO_REDES&#x27;: registro.posible_danio_redes
          });
        }
        const ws: XLSX.WorkSheet &#x3D;XLSX.utils.json_to_sheet(datos, headers);
        const wb: XLSX.WorkBook &#x3D; XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, &#x27;Reporte&#x27;);
        let today &#x3D; new Date();
        let dd &#x3D; String(today.getDate()).padStart(2, &#x27;0&#x27;);
        let mm &#x3D; String(today.getMonth() + 1).padStart(2, &#x27;0&#x27;); //January is 0!
        let yyyy &#x3D; today.getFullYear();
        XLSX.writeFile(wb, &#x60;Lista_PKs_Priorizados_${dd}${mm}${yyyy}.xlsx&#x60;);
      }
    }
    changeExcel(){
        this.inputXls.nativeElement.click()
    }
    uploadExcel(event: any) {
      this.file &#x3D; event.target.files[0];
      let fileReader &#x3D; new FileReader();
      let arrBuffer:any&#x3D;null;
      let fileList:any[];
      fileReader.readAsArrayBuffer(this.file);
      fileReader.onload &#x3D; (e) &#x3D;&gt; {
          arrBuffer &#x3D; fileReader.result;
          var data &#x3D; new Uint8Array(arrBuffer);
          var arr &#x3D; new Array();
          for(var i &#x3D; 0; i !&#x3D; data.length; ++i) arr[i] &#x3D; String.fromCharCode(data[i]);
          var bstr &#x3D; arr.join(&quot;&quot;);
          var workbook &#x3D; XLSX.read(bstr, {type:&quot;binary&quot;});
          var first_sheet_name &#x3D; workbook.SheetNames[0];
          var worksheet &#x3D; workbook.Sheets[first_sheet_name];
          //console.log(XLSX.utils.sheet_to_json(worksheet,{raw:true}));
          var arraylist &#x3D; XLSX.utils.sheet_to_json(worksheet,{raw:true});
          arraylist.forEach((item:any)&#x3D;&gt;{
            console.log(&quot;fromXls: &quot;, item);
            let pkFilter &#x3D; this.dataSource.data.filter((data)&#x3D;&gt;{
              return data.pk_id_calzada &#x3D;&#x3D; item[&quot;PK ID&quot;];
            });
            if(pkFilter.length&gt;0)
              this.updateCheckedList({checked:true}, {pk_id_calzada:item[&quot;PK ID&quot;]});
          });
      }
    }
}
interface LooseObject {
  [key: string]: any
}
</code></pre>
    </div>
</div>







                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'LooseObject-8.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
